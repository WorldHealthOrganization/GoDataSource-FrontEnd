<app-basic-page-v2
  [breadcrumbs]="breadcrumbs"
  [pageTitle]="pageTitle"
  [actionButton]="actionButton"
  [actionButtonLoading]="actionButtonLoading">

  <!-- Spreadsheet Editor -->
  <ag-grid-angular
    class="ag-theme-balham gd-spreadsheet-editor"
    [modules]="modules"
    enableCellChangeFlash="true"
    undoRedoCellEditing="false"
    suppressRowClickSelection="true"
    suppressClipboardPaste="true"
    [loadingOverlayComponent]="AppSpreadsheetEditorV2LoadingComponent"
    [noRowsOverlayComponent]="AppSpreadsheetEditorV2NoDataComponent"
    (gridReady)="gridReady($event)"
    (mouseleave)="gridMouseLeave()"
    (mousemove)="gridMouseMove($event)"
    (bodyScroll)="gridBodyScroll()"
    (cellEditingStopped)="gridCellEditingStopped($event)">
  </ag-grid-angular>

</app-basic-page-v2>

<!-- Cell - Context menu for spreadsheet-editor -->
<ng-template
  #cellContextMenu>
  <div
    cdkMenu
    class="gd-context-menu">

    <!-- Cut -->
    <!-- #TODO -->
    <button
      class="gd-context-menu-item"
      fxLayout="row"
      cdkMenuItem
      [disabled]="editor.selection.selected.ranges.length < 1">
      <!-- Label -->
      <div
        class="gd-context-menu-item-label"
        fxFlex fxLayoutAlign="start">
        {{'LNG_SHEET_CONTEXT_MENU_CUT' | translate}}
      </div>

      <!-- Shortcut -->
      <div
        fxGrow="0">
        Ctrl+X
      </div>
    </button>

    <!-- Copy -->
    <!-- #TODO -->
    <button
      class="gd-context-menu-item"
      fxLayout="row"
      cdkMenuItem
      [disabled]="editor.selection.selected.ranges.length < 1">
      <!-- Label -->
      <div
        class="gd-context-menu-item-label"
        fxFlex fxLayoutAlign="start">
        {{'LNG_SHEET_CONTEXT_MENU_COPY' | translate}}
      </div>

      <!-- Shortcut -->
      <div
        fxGrow="0">
        Ctrl+C
      </div>
    </button>

    <!-- Paste -->
    <!-- #TODO -->
    <button
      class="gd-context-menu-item"
      fxLayout="row"
      cdkMenuItem
      [disabled]="editor.selection.selected.ranges.length !== 1">
      <!-- Label -->
      <div
        class="gd-context-menu-item-label"
        fxFlex fxLayoutAlign="start">
        {{'LNG_SHEET_CONTEXT_MENU_PASTE' | translate}}
      </div>

      <!-- Shortcut -->
      <div
        fxGrow="0">
        Ctrl+V
      </div>
    </button>

    <!-- Undo -->
    <button
      class="gd-context-menu-item"
      fxLayout="row"
      cdkMenuItem
      [disabled]="changesIndex < 1"
      (click)="cellUndo()">
      <!-- Label -->
      <div
        class="gd-context-menu-item-label"
        fxFlex fxLayoutAlign="start">
        {{'LNG_SHEET_CONTEXT_MENU_UNDO' | translate}}
      </div>

      <!-- Shortcut -->
      <div
        fxGrow="0">
        Ctrl+Z
      </div>
    </button>

    <!-- Redo -->
    <button
      class="gd-context-menu-item"
      fxLayout="row"
      cdkMenuItem
      [disabled]="changesIndex >= changes.length"
      (click)="cellRedo()">
      <!-- Label -->
      <div
        class="gd-context-menu-item-label"
        fxFlex fxLayoutAlign="start">
        {{'LNG_SHEET_CONTEXT_MENU_REDO' | translate}}
      </div>

      <!-- Shortcut -->
      <div
        fxGrow="0">
        Ctrl+Y
      </div>
    </button>

    <!-- Splitter -->
    <hr
      *ngIf="editor.action === CreateViewModifyV2Action.CREATE" />

    <!-- Add rows above -->
    <!-- #TODO -->
    <button
      *ngIf="editor.action === CreateViewModifyV2Action.CREATE"
      class="gd-context-menu-item"
      cdkMenuItem
      fxLayout="row">
      <!-- Label -->
      <div
        class="gd-context-menu-item-label"
        fxFlex fxLayoutAlign="start">
        {{'LNG_SHEET_CONTEXT_MENU_ROW_ABOVE' | translate}}
      </div>
    </button>

    <!-- Add rows bellow -->
    <!-- #TODO -->
    <button
      *ngIf="editor.action === CreateViewModifyV2Action.CREATE"
      class="gd-context-menu-item"
      fxLayout="row"
      cdkMenuItem>
      <!-- Label -->
      <div
        class="gd-context-menu-item-label"
        fxFlex fxLayoutAlign="start">
        {{'LNG_SHEET_CONTEXT_MENU_ROW_BELOW' | translate}}
      </div>
    </button>

    <!-- Splitter -->
    <hr />

    <!-- Delete cells content -->
    <button
      class="gd-context-menu-item"
      fxLayout="row"
      cdkMenuItem
      [disabled]="editor.selection.selected.ranges.length !== 1"
      (click)="cellDeleteContent()">
      <!-- Label -->
      <div
        class="gd-context-menu-item-label"
        fxFlex fxLayoutAlign="start">
        {{'LNG_SHEET_CONTEXT_MENU_DELETE' | translate}}
      </div>

      <!-- Shortcut -->
      <div
        fxGrow="0">
        Delete
      </div>
    </button>

    <!-- Delete rows -->
    <!-- #TODO -->
    <button
      *ngIf="editor.action === CreateViewModifyV2Action.CREATE"
      class="gd-context-menu-item"
      fxLayout="row"
      cdkMenuItem>
      <!-- Label -->
      <div
        class="gd-context-menu-item-label"
        fxFlex fxLayoutAlign="start">
        {{'LNG_SHEET_CONTEXT_MENU_REMOVE_ROW' | translate}}
      </div>
    </button>



    <!-- #TODO -->
    <button
      class="gd-context-menu-item"
      cdkMenuItem>
      Copy and configure
    </button>
    <button
      class="gd-context-menu-item"
      cdkMenuItem>
      Paste and configure...
    </button>
  </div>
</ng-template>
