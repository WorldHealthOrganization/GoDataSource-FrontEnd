<div
    class="dialog-main app-theme"
    fxLayout="column"
>
    <div
        class="dialog-main-msg"
        [innerHTML]="confirmData?.message | translate:confirmData?.translateData">
    </div>

    <div
        *ngIf="confirmData?.additionalInfo"
        class="dialog-additional-info"
        [innerHTML]="confirmData?.additionalInfo.localeCompare ? (confirmData?.additionalInfo | translate:confirmData?.translateData) : confirmData?.additionalInfo">
    </div>

    <form #form="ngForm" fxLayout="column">
        <div
            *ngIf="confirmData?.customInput"
            fxLayout="column"
        >
            <!-- Single input -->
            <ng-container *ngIf="!confirmData?.fieldsList || confirmData?.fieldsList.length < 1">
                <ng-container *ngIf="confirmData?.customInputOptions">
                    <div fxLayout="row">
                        <app-form-select
                            name="value"
                            [(ngModel)]="dialogAnswerInputValue.value"
                            [placeholder]="confirmData.placeholder | translate:confirmData?.translateData"
                            [options]="confirmData.customInputOptions"
                            optionLabelKey="label"
                            optionValueKey="value"
                            [multiple]="confirmData.customInputOptionsMultiple"
                            [required]="confirmData.required">
                        </app-form-select>
                    </div>
                </ng-container>
                <ng-container *ngIf="!confirmData?.customInputOptions">
                    <div fxLayout="row">
                        <app-form-input
                            name="value"
                            [(ngModel)]="dialogAnswerInputValue.value"
                            [placeholder]="confirmData.placeholder | translate:confirmData?.translateData"
                            [required]="confirmData.required"
                            type="number">
                        </app-form-input>
                    </div>
                </ng-container>
            </ng-container>

            <!-- Multiple inputs -->
            <div
                *ngIf="confirmData?.fieldsList?.length > 0"
                fxLayout="row wrap" fxLayoutGap="20px">
                <div
                    *ngFor="let field of confirmData.fieldsList; let fieldIndex = index"
                    [fxFlex]="confirmData.fieldsListLayoutCss[fieldIndex]"
                    class="field-list-item">
                    <div
                        *ngIf="field.isVisible(dialogAnswerInputValue.value)">

                        <div
                            *ngIf="field.fieldType === DialogFieldType.SELECT">
                            <!-- Select -->
                            <app-form-select
                                [name]="field.name"
                                [(ngModel)]="dialogAnswerInputValue.value[field.name]"
                                [placeholder]="field.placeholder | translate:confirmData?.translateData"
                                [tooltip]="field.description"
                                [options]="field.inputOptions"
                                [clearable]="field.inputOptionsClearable"
                                optionLabelKey="label"
                                optionValueKey="value"
                                [multiple]="field.inputOptionsMultiple"
                                [required]="field.required"
                                [disabled]="field.disabled">
                            </app-form-select>
                        </div>

                        <div
                            *ngIf="field.fieldType === DialogFieldType.TEXT && field.type !== 'number'">
                            <!-- Text -->
                            <app-form-input
                                [name]="field.name"
                                [(ngModel)]="dialogAnswerInputValue.value[field.name]"
                                [placeholder]="field.placeholder | translate:confirmData?.translateData"
                                [tooltip]="field.description"
                                [required]="field.required"
                                [type]="field.type"
                                [disabled]="field.disabled">
                            </app-form-input>
                        </div>

                        <div
                            *ngIf="field.fieldType === DialogFieldType.TEXT && field.type === 'number'">
                            <!-- Number -->
                            <app-form-input
                                [name]="field.name"
                                [(ngModel)]="dialogAnswerInputValue.value[field.name]"
                                [placeholder]="field.placeholder | translate:confirmData?.translateData"
                                [tooltip]="field.description"
                                [required]="field.required"
                                type="number"
                                [disabled]="field.disabled"
                                app-min-max-validator
                                [min]="field.min"
                                [minNumber]="field.min"
                                [max]="field.max"
                                [maxNumber]="field.max">
                            </app-form-input>
                        </div>

                        <div
                            *ngIf="field.fieldType === DialogFieldType.BOOLEAN">
                            <!-- Boolean -->
                            <app-form-slide-toggle
                                [name]="field.name"
                                [(ngModel)]="dialogAnswerInputValue.value[field.name]"
                                [label]="field.placeholder | translate:confirmData?.translateData"
                                [tooltip]="field.description"
                                [disabled]="field.disabled">
                            </app-form-slide-toggle>
                        </div>

                        <div
                            *ngIf="field.fieldType === DialogFieldType.DATE">
                            <!-- Date -->
                            <app-form-datepicker
                                [name]="field.name"
                                [ngModel]="dialogAnswerInputValue.value[field.name]"
                                [placeholder]="field.placeholder | translate:confirmData?.translateData"
                                [tooltip]="field.description"
                                [required]="field.required"
                                [disabled]="field.disabled"
                                (optionChanged)="setDateValue(field.name, $event)"
                                app-date-validator
                            ></app-form-datepicker>
                        </div>

                        <div
                            *ngIf="field.fieldType === DialogFieldType.DATE_RANGE">
                            <!-- Date range -->
                            <app-form-daterange
                                [name]="field.name"
                                [(ngModel)]="dialogAnswerInputValue.value[field.name]"
                                [required]="field.required"
                                [disabled]="field.disabled">
                            </app-form-daterange>
                        </div>

                        <!-- Link -->
                        <a
                            *ngIf="field.fieldType === DialogFieldType.LINK"
                            [routerLink]="field.routerLink"
                            [queryParams]="field.queryParams"
                            [target]="field.linkTarget">
                            {{ field.placeholder | translate }}
                        </a>

                        <!-- Url -->
                        <div
                            *ngIf="field.fieldType === DialogFieldType.URL">
                            <app-form-input
                                [name]="field.name"
                                [(ngModel)]="dialogAnswerInputValue.value[field.name]"
                                [placeholder]="field.placeholder | translate:confirmData?.translateData"
                                [tooltip]="field.description"
                                [required]="field.required"
                                [disabled]="field.disabled"
                                app-general-async-validator
                                [asyncValidatorObservable]="field.urlAsyncValidator(dialogAnswerInputValue.value[field.name])"
                                [asyncValidatorErrMsg]="field.urlAsyncErrorMsg"
                                [asyncValidatorErrMsgTranslateData]="field.urlAsyncErrorMsgData">
                            </app-form-input>
                        </div>

                        <!-- Action -->
                        <div
                            *ngIf="field.fieldType === DialogFieldType.ACTION"
                            [class]="'dialog-action ' + (field.actionCallback ? 'dialog-action-has-action' : '')"
                            (click)="field.actionCallback ? field.actionCallback(field.actionData) : false">
                            {{ field.placeholder | translate }}
                        </div>

                        <!-- Section Title -->
                        <div
                            *ngIf="field.fieldType === DialogFieldType.SECTION_TITLE"
                            class="dialog-section-title">
                            {{ field.placeholder | translate }}
                        </div>

                        <!-- Info Section Title -->
                        <div
                            *ngIf="field.fieldType === DialogFieldType.INFO_SECTION_TITLE && confirmData?.infoFields"
                            class="dialog-section-title">
                            {{ field.placeholder | translate }}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Info Section -->
        <ng-container *ngIf="confirmData?.infoExistingConfiguration">
            <div *ngFor="let infoField of confirmData?.infoFields">
                <ng-container *ngIf="infoField.type != DialogFieldType.INFO_SECTION_TITLE">
                    {{infoField.token | translate}} : {{ infoField.value}}
                </ng-container>
            </div>
        </ng-container>

        <div fxLayout="row" fxLayoutAlign="end">
            <button
                *ngFor="let dialogButton of confirmData?.buttons"
                mat-button
                type="button"
                class="dialog-button"
                [ngClass]="dialogButton.cssClass"
                (click)="dialogButton.clickCallback(dialogRef, dialogAnswerInputValue)"
                [disabled]="dialogButton.disabled()">
                {{ dialogButton.label | translate:confirmData?.translateData }}
            </button>
        </div>
    </form>

</div>
