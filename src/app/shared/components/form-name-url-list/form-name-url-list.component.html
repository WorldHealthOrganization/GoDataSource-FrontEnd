<div class="form-element"
     [id]="identifier" [ngClass]="{invalid: (invalid)}">

    <form
        #groupForm="ngForm"
        fxLayout="column"
    >
        <div
            *ngFor="let inputValue of values; let i = index; trackBy: trackByIndex"
            fxLayout="row" fxLayoutAlign="start center">
            <mat-card
                class="page-section"
                fxFlex fxLayout="column"
            >
                <div
                    fxLayout="row" fxLayoutGap="20px">
                    <app-form-input
                        [name]="name + '[' + i + '][name]'"
                        [(ngModel)]="values[i].name"
                        [placeholder]="namePlaceholder"
                        [tooltip]="nameTooltip"
                        [disabled]="disabled"
                        (optionChanged)="onChange()"
                        [required]="required">
                    </app-form-input>

                    <div fxFlex><!-- placeholder --></div>
                    <div fxFlex><!-- placeholder --></div>
                    <div fxFlex><!-- placeholder --></div>
                </div>
                <div
                    fxLayout="row" fxLayoutGap="20px">
                    <app-form-input
                        [name]="name + '[' + i + '][url]'"
                        [(ngModel)]="values[i].url"
                        [placeholder]="urlPlaceholder"
                        [tooltip]="urlTooltip"
                        [disabled]="disabled"
                        (optionChanged)="onChange()"
                        [required]="required">
                    </app-form-input>
                </div>

                <div
                    fxLayout="row" fxLayoutGap="20px">
                     <app-form-select
                        [name]="name + '[' + i + '][type]'"
                        [(ngModel)]="values[i].type"
                        [placeholder]="typePlaceholder"
                        [disabled]="disabled"
                        (optionChanged)="onChange()"
                        [options]="outbreakMapServerTypesList$ | async"
                        optionLabelKey="label"
                        optionValueKey="value">
                    </app-form-select>

                    <div
                        fxLayout="row" fxLayoutAlign="none center" fxLayoutGap="-20px">
                        <!-- details popover -->
                        <mde-popover
                            #mappingMdePopover="mdePopover"
                            class="mdePopover"
                            mdePopoverTriggerOn="hover">
                                    <span
                                        [innerHTML]="typeTooltip | translate | safeHtml">
                                    </span>
                        </mde-popover>

                        <!-- help button -->
                        <span
                            class="xt-icon xt-icon-xsmall"
                            [mdePopoverTriggerFor]="mappingMdePopover">help</span>
                    </div>
                </div>
            </mat-card>

            <button
                *ngIf="!disabled"
                type="button" mat-icon-button
                (click)="delete(i)">
                <span class="xt-icon">delete</span>
            </button>
        </div>

        <div
            *ngIf="!disabled"
            fxLayout="row">
            <button type="button" mat-button color="primary" (click)="add()">{{ 'LNG_INPUT_LABEL_ADD_ITEM' | translate }}</button>
        </div>
    </form>
</div>
