<app-topnav [activeOutbreakEditable]="false">
    <ng-container dynamic-section>
        <app-breadcrumbs [items]="breadcrumbs"></app-breadcrumbs>
    </ng-container>
</app-topnav>

<form
    #form="ngForm"
    class="page-content form-section"
    [class.form-view-only]="viewOnly"
    (submit)="modifyLabResult(form)">

    <div class="form-content">
        <mat-tab-group class="page-tabs-navbar">
            <mat-tab [label]="'LNG_PAGE_MODIFY_LAB_RESULT_TAB_QUESTIONNAIRE_TITLE' | translate">
                <app-form-fill-questionnaire
                    *ngIf="!!labResultData?.id"
                    name="questionnaireAnswers"
                    [ngModel]="labResultData.questionnaireAnswers"
                    [questions]="selectedOutbreak.labResultsTemplate"
                    [disabled]="viewOnly"
                    [componentTitle]="'LNG_PAGE_MODIFY_LAB_RESULT_TAB_QUESTIONNAIRE_TITLE' | translate">
                </app-form-fill-questionnaire>
            </mat-tab>
        </mat-tab-group>
    </div>

    <div class="form-actions">
        <div class="form-actions-no-scroll">
            <div class="page-tabs-navbar-placeholder"></div>

            <ng-container
                *app-selected-outbreak-is-active>
                <button
                    *ngIf="viewOnly && LabResultModel.canModify(authUser)"
                    type="button"
                    mat-raised-button color="accent"
                    [routerLink]="['/lab-results', labResultId, 'modify-questionnaire']">
                    {{'LNG_COMMON_BUTTON_EDIT' | translate}}
                </button>

                <button
                    *ngIf="!viewOnly"
                    class="button-with-spinner"
                    mat-raised-button color="accent">
                    {{'LNG_COMMON_BUTTON_SAVE' | translate}}
                </button>
            </ng-container>

            <button
                type="button"
                [routerLink]="['/lab-results', EntityModel.getLinkForEntityType(this.labResultData?.personType), labResultData?.personId, labResultId, viewOnly ? 'view' : 'modify']"
                [queryParams]="{fromLabResultsList: fromLabResultsList}"
                mat-raised-button>
                {{'LNG_COMMON_BUTTON_BACK' | translate}}
            </button>
        </div>
    </div>
</form>
