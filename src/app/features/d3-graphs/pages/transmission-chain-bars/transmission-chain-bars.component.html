<app-basic-page-v2
  [breadcrumbs]="breadcrumbs"
  pageTitle="LNG_PAGE_TRANSMISSION_CHAIN_BARS_TITLE"
  [quickActions]="quickActions">

  <div class="filters" fxLayout="column" fxLayoutGap="10px">
    <div>
      <button
        mat-raised-button
        (click)="toggleFilters()">
        {{ toggleFiltersButtonLabel | translate }}
      </button>
    </div>

    <div
      [fxShow]="filtersVisible"
      fxLayout="column" fxLayoutGap="20px"
    >
      <div fxLayout="row" fxLayoutAlign="start end" fxLayoutGap="20px">
        <!-- Date of onset -->
        <div fxFlex fxLayout="column" fxLayoutGap="10px">
          <div>{{ 'LNG_PAGE_TRANSMISSION_CHAIN_BARS_FIELD_LABEL_DATE' | translate }}</div>

          <div fxLayout="row">
            <app-form-daterange
              name="date"
              [ngModel]="filters.date"
              (changed)="filters.date = $event"
            ></app-form-daterange>
          </div>
        </div>

        <!-- Location -->
        <!--                <app-form-location-dropdown-->
        <!--                    fxFlex-->
        <!--                    name="locationId"-->
        <!--                    [(ngModel)]="filters.locationId"-->
        <!--                    [useOutbreakLocations]="true"-->
        <!--                    [placeholder]="'LNG_ADDRESS_FIELD_LABEL_LOCATION' | translate"-->
        <!--                ></app-form-location-dropdown>-->
      </div>

      <div fxLayout="row" fxLayoutAlign="start end" fxLayoutGap="20px">
        <!-- Hospitalisation / Isolation date -->
        <div fxFlex fxLayout="column" fxLayoutGap="10px">
          <div>{{ 'LNG_PAGE_TRANSMISSION_CHAIN_BARS_FILTERS_HOSPITALISATION_ISOLATION' | translate }}</div>

          <div fxLayout="row">
            <app-form-daterange
              name="isolationDate"
              [ngModel]="filters.isolationDate"
              (changed)="filters.isolationDate = $event"
            ></app-form-daterange>
          </div>
        </div>

        <!-- Hospitalisation / Isolation center name -->
        <app-form-select
          fxFlex
          name="isolationCenterName"
          [(ngModel)]="filters.isolationCenterName"
          [placeholder]="'LNG_CASE_FIELD_LABEL_DATE_RANGE_CENTER_NAME' | translate"
          [options]="dateRangeCentreNameList$ | async"
          [allowSelectionOfDisabledItems]="true"
          [displayFilterIcon]="true"
          [multiple]="true">
        </app-form-select>
      </div>

      <div fxLayout="row" fxLayoutAlign="start end" fxLayoutGap="20px">
        <!-- Case classification -->
        <div fxFlex fxLayout="column" fxLayoutGap="10px">
          <div>
            {{ 'LNG_PAGE_TRANSMISSION_CHAIN_BARS_FILTERS_CASE_CLASSIFICATION' | translate }}
          </div>

          <div fxLayout="row">
            <app-form-select
              name="caseClassification"
              [placeholder]="'LNG_CASE_FIELD_LABEL_CLASSIFICATION' | translate"
              [options]="caseClassificationsList$ | async"
              [(ngModel)]="filters.caseClassification"
              [allowSelectionOfDisabledItems]="true"
              [multiple]="true">
            </app-form-select>
          </div>
        </div>

        <!-- Case outcome -->
        <div fxFlex fxLayout="column" fxLayoutGap="10px">
          <div>
            {{ 'LNG_PAGE_TRANSMISSION_CHAIN_BARS_FILTERS_CASE_OUTCOME' | translate }}
          </div>

          <div fxLayout="row">
            <app-form-select
              name="caseOutcome"
              [placeholder]="'LNG_CASE_FIELD_LABEL_OUTCOME' | translate"
              [options]="caseOutcomeList$ | async"
              [(ngModel)]="filters.caseOutcome"
              [allowSelectionOfDisabledItems]="true"
              [multiple]="true">
            </app-form-select>
          </div>
        </div>
      </div>

      <!-- Action buttons -->
      <div fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="10px">
        <button
          mat-raised-button
          (click)="resetFilters()"
        >
          {{ 'LNG_COMMON_BUTTON_RESET_FILTERS' | translate }}
        </button>

        <button
          mat-raised-button
          color="accent"
          (click)="applyFilters()"
        >
          {{ 'LNG_COMMON_BUTTON_APPLY_FILTERS' | translate }}
        </button>
      </div>
    </div>
  </div>

  <div
    [fxShow]="!loadingData && !noData">
    <!-- Chart details -->
    <div
      [innerHTML]="('LNG_PAGE_TRANSMISSION_CHAIN_BARS_LEGEND_DETAILS' | translate:legendColors) | safeHtml"
      class="transmission-chain-bars-legend">
    </div>

    <!-- Chart cell width -->
    <div
      class="transmission-chain-bars-cell-width">
      <div>
        {{ 'LNG_PAGE_TRANSMISSION_CHAIN_BARS_CELL_WIDTH_LABEL' | translate }}
      </div>
      <mat-slider
        [min]="91"
        [max]="150"
        [ngModel]="cellWidth"
        [tickInterval]="10"
        (valueChange)="cellWidthChanged($event)">
      </mat-slider>
    </div>

    <!-- Chart -->
    <div
      #chart
      id="chart"
    ></div>
  </div>

  <div *ngIf="!loadingData && noData">
    {{'LNG_PAGE_TRANSMISSION_CHAIN_BARS_NO_DATA' | translate}}
  </div>

  <div *ngIf="loadingData">
    <mat-spinner></mat-spinner>
  </div>

</app-basic-page-v2>
