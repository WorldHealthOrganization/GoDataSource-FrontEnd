<app-topnav>
    <ng-container dynamic-section>
        <div fxLayout="row" fxFlex fxLayoutAlign="space-between center">
            <app-breadcrumbs [items]="breadcrumbs"></app-breadcrumbs>
        </div>
    </ng-container>
</app-topnav>

<mat-card class="page-section page-content">

    <mat-table #table [dataSource]="labResultsList$ | async" matSort (matSortChange)="sortBy($event)">

        <!-- Sample Lab Identifier -->
        <ng-container matColumnDef="id">
            <mat-header-cell *matHeaderCellDef>
                <div class="table-header-cell">
                    <div mat-sort-header>{{ 'LNG_CASE_LAB_RESULT_FIELD_LABEL_ID' | translate }}</div>
                    <div class="column-filter">
                        <app-form-input
                            name="idFilter"
                            ngModel
                            [placeholder]="'LNG_LAYOUT_LIST_DEFAULT_FILTER_PLACEHOLDER' | translate"
                            (optionChanged)="filterByTextField('id', $event)">
                        </app-form-input>
                    </div>
                </div>
            </mat-header-cell>

            <mat-cell *matCellDef="let item">
                {{ item.id }}
            </mat-cell>
        </ng-container>

        <!-- Date sample taken -->
        <ng-container matColumnDef="dateSampleTaken">
            <mat-header-cell *matHeaderCellDef>
                <div class="table-header-cell">
                    <div mat-sort-header>{{ 'LNG_CASE_LAB_RESULT_FIELD_LABEL_DATE_SAMPLE_TAKEN' | translate }}</div>
                    <div class="column-filter">
                        <!-- @TODO later -->
                    </div>
                </div>
            </mat-header-cell>

            <mat-cell *matCellDef="let item">
                {{ item.dateSampleTaken | date: Constants.DEFAULT_DATE_DISPLAY_FORMAT }}
            </mat-cell>
        </ng-container>

        <!-- Date sample delivered to lab -->
        <ng-container matColumnDef="dateSampleDelivered">
            <mat-header-cell *matHeaderCellDef>
                <div class="table-header-cell">
                    <div mat-sort-header>{{ 'LNG_CASE_LAB_RESULT_FIELD_LABEL_DATE_SAMPLE_DELIVERED' | translate}}</div>
                    <div class="column-filter">
                        <!-- @TODO later -->
                    </div>
                </div>
            </mat-header-cell>

            <mat-cell *matCellDef="let item">
                {{ item.dateSampleDelivered | date: Constants.DEFAULT_DATE_DISPLAY_FORMAT }}
            </mat-cell>
        </ng-container>

        <!-- Date of the result -->
        <ng-container matColumnDef="dateOfResult">
            <mat-header-cell *matHeaderCellDef>
                <div class="table-header-cell">
                    <div mat-sort-header>{{ 'LNG_CASE_LAB_RESULT_FIELD_LABEL_DATE_OF_RESULT' | translate }}</div>
                    <div class="column-filter">
                        <!-- @TODO later -->
                    </div>
                </div>
            </mat-header-cell>

            <mat-cell *matCellDef="let item">
                {{ item.dateOfResult | date: Constants.DEFAULT_DATE_DISPLAY_FORMAT }}
            </mat-cell>
        </ng-container>

        <!-- Lab Name -->
        <ng-container matColumnDef="labName">
            <mat-header-cell *matHeaderCellDef>
                <div class="table-header-cell">
                    <div mat-sort-header>{{ 'LNG_CASE_LAB_RESULT_FIELD_LABEL_LAB_NAME' | translate }}</div>
                    <div class="column-filter">
                        <app-form-input
                            name="labNameFilter"
                            ngModel
                            [placeholder]="'LNG_LAYOUT_LIST_DEFAULT_FILTER_PLACEHOLDER' | translate"
                            (optionChanged)="filterByTextField('labName', $event)">
                        </app-form-input>
                    </div>
                </div>
            </mat-header-cell>

            <mat-cell *matCellDef="let item">
                {{ item.labName }}
            </mat-cell>
        </ng-container>

        <!-- Sample type -->
        <ng-container matColumnDef="sampleType">
            <mat-header-cell *matHeaderCellDef>
                <div class="table-header-cell">
                    <div mat-sort-header>{{ 'LNG_CASE_LAB_RESULT_FIELD_LABEL_SAMPLE_TYPE' | translate}}</div>
                    <div class="column-filter">
                        <!-- @TODO later -->
                    </div>
                </div>
            </mat-header-cell>

            <mat-cell *matCellDef="let item">
                <app-reference-data-label
                    [category]="ReferenceDataCategory.TYPE_OF_SAMPLE"
                    [value]="item.sampleType">
                </app-reference-data-label>
            </mat-cell>
        </ng-container>

        <!-- Test type -->
        <ng-container matColumnDef="testType">
            <mat-header-cell *matHeaderCellDef>
                <div class="table-header-cell">
                    <div mat-sort-header>{{ 'LNG_CASE_LAB_RESULT_FIELD_LABEL_TEST_TYPE' | translate }}</div>
                    <div class="column-filter">
                        <!-- @TODO later -->
                    </div>
                </div>
            </mat-header-cell>

            <mat-cell *matCellDef="let item">
                <app-reference-data-label
                    [category]="ReferenceDataCategory.TYPE_OF_LAB_TEST"
                    [value]="item.testType">
                </app-reference-data-label>
            </mat-cell>
        </ng-container>

        <!-- Result -->
        <ng-container matColumnDef="result">
            <mat-header-cell *matHeaderCellDef>
                <div class="table-header-cell">
                    <div mat-sort-header>{{ 'LNG_CASE_LAB_RESULT_FIELD_LABEL_RESULT' | translate }}</div>
                    <div class="column-filter">
                        <!-- @TODO later -->
                    </div>
                </div>
            </mat-header-cell>

            <mat-cell *matCellDef="let item">
                <app-reference-data-label
                    [category]="ReferenceDataCategory.LAB_TEST_RESULT"
                    [value]="item.result">
                </app-reference-data-label>
            </mat-cell>
        </ng-container>


        <mat-header-row *matHeaderRowDef="getTableColumns()"></mat-header-row>
        <mat-row *matRowDef="let item; columns: getTableColumns()"></mat-row>
    </mat-table>

</mat-card>
