<app-topnav [activeOutbreakEditable]="false">
    <ng-container dynamic-section>
        <app-breadcrumbs [items]="breadcrumbs"></app-breadcrumbs>
    </ng-container>
</app-topnav>

<div class="page-content">
    <form class="form-section">
        <div class="form-content">
            <mat-card class="page-section" fxLayout="column">

                <div fxLayout="column" fxLayoutGap="5px" class="info-container">
                    <div>
                        {{ 'LNG_PAGE_BULK_ADD_CONTACTS_OF_CONTACTS_VISUAL_ID_INFO_LABEL' | translate: contactOfContactVisualIdModel }}
                    </div>
                </div>

                <ng-container
                    *ngIf="errorMessages && errorMessages.length > 0">
                    <div
                        class="bulk-create-contacts-of-contacts-errors">
                        <div
                            class="bulk-create-contacts-of-contacts-errors-title">
                            {{ 'LNG_PAGE_BULK_ADD_CONTACTS_OF_CONTACTS_LABEL_ERRORS' | translate }}
                        </div>
                        <div
                            *ngFor="let err of errorMessages">
                            {{ err.message | translate:err.data }}
                        </div>
                    </div>
                </ng-container>

                <div class="related-person" fxLayout="row" fxLayoutGap="20px">
                    <div>{{relatedEntityData?.type | translate}}</div>
                    <div>{{relatedEntityData?.name}}</div>
                </div>

                <div class="sheet-wrapper" fxLayout="row" fxLayoutAlign="center">
                    <input
                        #inputForMakingFormDirty="ngModel"
                        type="hidden"
                        ngModel
                        name="addContactsHidden"/>

                    <app-hot-table-wrapper
                        #hotTableWrapper
                        [sheetContextMenu]="sheetContextMenu"
                        [sheetColumns]="sheetColumns"
                        (afterBecameDirty)="afterBecameDirty()"
                        [startRows]="20"
                        [minSpareRows]="1"
                        widthReduction="320"
                    ></app-hot-table-wrapper>
                </div>

            </mat-card>
        </div>

        <div class="form-actions">
            <button
                mat-raised-button
                color="accent"
                (click)="addContactsOfContacts()">
                {{ 'LNG_COMMON_BUTTON_SAVE' | translate }}
            </button>
        </div>
    </form>
</div>
