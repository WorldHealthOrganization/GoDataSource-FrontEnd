<div
  class="gd-dashboard">

  <!-- Top -->
  <div
    class="gd-dashboard-top">

    <!-- Breadcrumbs -->
    <app-breadcrumb-v2
      *ngIf="breadcrumbs"
      [breadcrumbs]="breadcrumbs"></app-breadcrumb-v2>

    <!-- Title & buttons -->
    <div
      fxLayout="row"
      class="gd-dashboard-top-title-buttons">

      <!-- Title -->
      <div
        fxFlex
        class="gd-basic-top-title-buttons-title">
        {{'LNG_PAGE_DASHBOARD_TITLE' | translate}}
      </div>

      <!-- Buttons -->
      <div
        fxFlex fxLayoutAlign="end" fxLayoutGap="0.8rem"
        class="gd-basic-top-title-buttons-buttons">

        <!-- Advanced filters -->
        <button
          type="button"
          mat-flat-button
          color="primary"
          (click)="showAdvancedFilters()">
          <mat-icon>filter_alt</mat-icon>
          {{'LNG_SIDE_FILTERS_TITLE' | translate}}
        </button>

        <!-- Quick actions -->
        <ng-container
          *ngIf="quickActions && (!quickActions.visible || quickActions.visible(null))">

          <!-- Menu -->
          <!-- IMPORTANT: Menu of type icon isn't supported here -->
          <button
            #quickMenuTrigger="matMenuTrigger"
            class="gd-basic-top-title-buttons-buttons-quick"
            [class.gd-basic-top-title-buttons-buttons-quick-expanded]="quickMenuTrigger.menuOpen"
            type="button"
            mat-flat-button color="secondary"
            [disabled]="quickActions.disable && quickActions.disable(null)"
            [matMenuTriggerFor]="quickMenu"
            (menuClosed)="detectChanges()">

            <!-- Label -->
            <span>
              {{quickActions.label | translate}}
            </span>

            <!-- Icon -->
            <mat-icon>expand_more</mat-icon>
          </button>

          <!-- Floating menu -->
          <mat-menu
            #quickMenu="matMenu"
            class="gd-basic-top-title-buttons-buttons-quick-options">
            <ng-container
              *ngFor="let menuOption of quickActions.menuOptions">
              <ng-container
                *ngIf="!menuOption.visible || menuOption.visible(null)">

                <!-- Child Menu link -->
                <ng-container
                  *ngIf="menuOption.label; else divider">

                  <!-- Link -->
                  <a
                    *ngIf="menuOption.action.link; else notLink"
                    mat-menu-item
                    class="gd-basic-top-title-buttons-buttons-quick-options-option {{menuOption.cssClasses}}"
                    [routerLink]="menuOption.action.link && (!menuOption.disable || !menuOption.disable(null)) ? menuOption.action.link(null) : undefined"
                    [queryParams]="menuOption.action.linkQueryParams ? menuOption.action.linkQueryParams(null) : undefined"
                    [disabled]="menuOption.disable && menuOption.disable(null)">
                    {{menuOption.label.get(null) | translate:(menuOption.label.data ? menuOption.label.data(null) : undefined)}}
                  </a>

                  <!-- Button -->
                  <ng-template
                    #notLink>
                    <button
                      type="button"
                      mat-menu-item
                      class="gd-basic-top-title-buttons-buttons-quick-options-option {{menuOption.cssClasses}}"
                      [disabled]="menuOption.disable && menuOption.disable(null)"
                      (click)="menuOption.action.click ? menuOption.action.click(null) : undefined">
                      {{menuOption.label.get(null) | translate:(menuOption.label.data ? menuOption.label.data(null) : undefined)}}
                    </button>
                  </ng-template>

                </ng-container>

                <!-- Divider -->
                <ng-template
                  #divider>
                  <mat-divider></mat-divider>
                </ng-template>

              </ng-container>
            </ng-container>
          </mat-menu>

        </ng-container>

      </div>

    </div>

  </div>

  <!-- Bottom -->
  <div
    class="gd-dashboard-bottom">

    <!-- Cases KPI -->
    <app-cases-kpi-dashlet
      *ngIf="visibleDashlets.KPICases"
      [globalFilterDate]="globalFilterDate"
      [globalFilterLocationId]="globalFilterLocationId"
      [globalFilterClassificationId]="globalFilterClassificationId"></app-cases-kpi-dashlet>

    <!-- Contacts KPI -->
    <app-contacts-kpi-dashlet
      *ngIf="visibleDashlets.KPIContacts"
      [globalFilterDate]="globalFilterDate"
      [globalFilterLocationId]="globalFilterLocationId"
      [globalFilterClassificationId]="globalFilterClassificationId"></app-contacts-kpi-dashlet>

    <!-- COT KPI -->
    <app-cot-kpi-dashlet
      *ngIf="visibleDashlets.KPICOT"
      [globalFilterDate]="globalFilterDate"
      [globalFilterLocationId]="globalFilterLocationId"
      [globalFilterClassificationId]="globalFilterClassificationId"></app-cot-kpi-dashlet>

  </div>
</div>


<!--<div>-->
<!--  &lt;!&ndash;-->
<!--      <app-topnav>-->
<!--          <ng-container dynamic-section>-->
<!--              <div fxLayout="row" fxFlex fxLayoutAlign="space-between center">-->
<!--                  <app-breadcrumbs [items]="breadcrumbs"></app-breadcrumbs>-->

<!--                  <div-->
<!--                      *ngIf="!!selectedOutbreak?.id"-->
<!--                      class="topnav-actions">-->

<!--                      <button-->
<!--                          *ngIf="DashboardModel.canExportCaseClassificationPerLocationReport(authUser) || DashboardModel.canExportContactFollowUpSuccessRateReport(authUser) || (-->
<!--                              DashboardModel.canExportEpiCurve(authUser) && (-->
<!--                                  DashboardModel.canViewEpiCurveStratifiedByClassificationDashlet(authUser) ||-->
<!--                                  DashboardModel.canViewEpiCurveStratifiedByOutcomeDashlet(authUser) ||-->
<!--                                  DashboardModel.canViewEpiCurveStratifiedByClassificationOverReportTimeDashlet(authUser)-->
<!--                              )-->
<!--                          ) || (-->
<!--                              DashboardModel.canExportKpi(authUser) &&-->
<!--                              hasKpiAccess()-->
<!--                          )"-->
<!--                          mat-raised-button color="accent"-->
<!--                          [matMenuTriggerFor]="quickActionsMenu">-->
<!--                          {{'LNG_PAGE_DASHBOARD_REPORTS_BUTTON_LABEL' | translate}} <span class="xt-icon">arrowDown</span>-->
<!--                      </button>-->

<!--                      <mat-menu #quickActionsMenu="matMenu">-->
<!--                          <app-export-button-->
<!--                              *ngIf="DashboardModel.canExportCaseClassificationPerLocationReport(authUser)"-->
<!--                              [menuItem]="true"-->
<!--                              [fileType]="ExportDataExtension.PDF"-->
<!--                              [label]="'LNG_PAGE_DASHBOARD_CASES_BY_CLASSIFICATION_LOCATION_REPORT_LABEL' | translate"-->
<!--                              [message]="'LNG_PAGE_DASHBOARD_CASES_BY_CLASSIFICATION_LOCATION_REPORT_LABEL' | translate"-->
<!--                              [url]="casesByClassificationAndLocationReportUrl"-->
<!--                              [fileName]="'LNG_PAGE_DASHBOARD_CASES_BY_CLASSIFICATION_LOCATION_REPORT_LABEL' | translate"-->
<!--                              (exportStart)="showLoadingDialog()"-->
<!--                              (exportFinished)="closeLoadingDialog()"-->
<!--                              [queryBuilder]="qbCaseByClassification()">-->
<!--                          </app-export-button>-->

<!--                          <app-export-button-->
<!--                              *ngIf="DashboardModel.canExportContactFollowUpSuccessRateReport(authUser)"-->
<!--                              [menuItem]="true"-->
<!--                              [fileType]="ExportDataExtension.PDF"-->
<!--                              [label]="'LNG_PAGE_DASHBOARD_CONTACTS_FOLLOWUP_SUCCESS_RATE_REPORT_LABEL' | translate"-->
<!--                              [message]="'LNG_PAGE_DASHBOARD_CONTACTS_FOLLOWUP_SUCCESS_RATE_REPORT_LABEL' | translate"-->
<!--                              [url]="contactsFollowupSuccessRateReportUrl"-->
<!--                              [fileName]="'LNG_PAGE_DASHBOARD_CONTACTS_FOLLOWUP_SUCCESS_RATE_REPORT_LABEL' | translate"-->
<!--                              (exportStart)="showLoadingDialog()"-->
<!--                              (exportFinished)="closeLoadingDialog()"-->
<!--                              [queryBuilder]="qbContactsFollowUpSuccessRate()">-->
<!--                          </app-export-button>-->

<!--                          <button-->
<!--                              *ngIf="DashboardModel.canExportEpiCurve(authUser) && (-->
<!--                                  DashboardModel.canViewEpiCurveStratifiedByClassificationDashlet(authUser) ||-->
<!--                                  DashboardModel.canViewEpiCurveStratifiedByOutcomeDashlet(authUser) ||-->
<!--                                  DashboardModel.canViewEpiCurveStratifiedByClassificationOverReportTimeDashlet(authUser)-->
<!--                              )"-->
<!--                              mat-menu-item-->
<!--                              (click)="generateEpiCurveReport()">-->
<!--                              {{'LNG_PAGE_DASHBOARD_EPI_CURVE_REPORT_LABEL' | translate}}-->
<!--                          </button>-->

<!--                          <button-->
<!--                              *ngIf="DashboardModel.canExportKpi(authUser) && hasKpiAccess()"-->
<!--                              mat-menu-item-->
<!--                              (click)="generateKpisReport()">-->
<!--                              {{'LNG_PAGE_DASHBOARD_KPIS_REPORT_LABEL' | translate}}-->
<!--                          </button>-->
<!--                      </mat-menu>-->
<!--                  </div>-->
<!--              </div>-->
<!--          </ng-container>-->
<!--      </app-topnav>-->
<!--      &ndash;&gt;-->

<!--      <ng-container *ngIf="noOutbreaksInSystem">-->
<!--          <mat-card class="page-content page-section">-->
<!--              {{'LNG_PAGE_DASHBOARD_NO_OUTBREAKS_MESSAGE' | translate}}-->
<!--          </mat-card>-->
<!--      </ng-container>-->

<!--      <ng-container *ngIf="!noOutbreaksInSystem">-->
<!--          &lt;!&ndash; Side filters &ndash;&gt;-->
<!--        <app-side-filters-->
<!--            [filterOptions]="availableSideFilters"-->
<!--            (filtersCollected)="applySideFilters($event)"-->
<!--            [fixedFilters]="true">-->
<!--        </app-side-filters>-->

<!--        &lt;!&ndash; Dashboard items &ndash;&gt;-->
<!--        <div-->
<!--            class="page-content"-->
<!--            fxLayout="column">-->
<!--            &lt;!&ndash; Pie Charts &ndash;&gt;-->
<!--            <mat-expansion-panel-->
<!--                *ngIf="DashboardModel.canViewCaseSummaryDashlet(authUser) || DashboardModel.canViewCasePerLocationLevelDashlet(authUser) || DashboardModel.canViewCaseHospitalizedPieChartDashlet(authUser)">-->
<!--                &lt;!&ndash; Header &ndash;&gt;-->
<!--                <mat-expansion-panel-header>-->
<!--                    <div class="other-kpi-header">-->
<!--                        {{'LNG_PAGE_DASHBOARD_PIE_CHARTS_TITLE' | translate}}-->
<!--                    </div>-->
<!--                </mat-expansion-panel-header>-->

<!--                &lt;!&ndash; Dashlets &ndash;&gt;-->
<!--                <ng-template matExpansionPanelContent>-->
<!--                    <div-->
<!--                        fxLayout="row"-->
<!--                        fxLayoutGap="10px">-->
<!--                        &lt;!&ndash; Summary &ndash;&gt;-->
<!--                        <div-->
<!--                            *ngIf="DashboardModel.canViewCaseSummaryDashlet(authUser)"-->
<!--                            fxFlex="33">-->
<!--                            <mat-card-->
<!--                                class="dashboard-gauge">-->
<!--                                <app-case-summary-dashlet-->
<!--                                    [globalFilterDate]="globalFilterDate"-->
<!--                                    [globalFilterLocationId]="globalFilterLocationId"-->
<!--                                    [globalFilterClassificationId]="globalFilterClassificationId">-->
<!--                                </app-case-summary-dashlet>-->
<!--                            </mat-card>-->
<!--                        </div>-->

<!--                        &lt;!&ndash; Location &ndash;&gt;-->
<!--                        <div-->
<!--                            *ngIf="DashboardModel.canViewCasePerLocationLevelDashlet(authUser)"-->
<!--                            fxFlex="33">-->
<!--                            <mat-card-->
<!--                                class="dashboard-gauge">-->
<!--                                <app-case-by-geographic-location-dashlet-->
<!--                                    [globalFilterDate]="globalFilterDate"-->
<!--                                    [globalFilterLocationId]="globalFilterLocationId"-->
<!--                                    [globalFilterClassificationId]="globalFilterClassificationId">-->
<!--                                </app-case-by-geographic-location-dashlet>-->
<!--                            </mat-card>-->
<!--                        </div>-->

<!--                        &lt;!&ndash; Hospitalized &ndash;&gt;-->
<!--                        <div-->
<!--                            *ngIf="DashboardModel.canViewCaseHospitalizedPieChartDashlet(authUser)"-->
<!--                            fxFlex="33">-->
<!--                            <mat-card-->
<!--                                class="dashboard-gauge">-->
<!--                                <app-cases-hospitalized-pie-chart-dashlet-->
<!--                                    [globalFilterDate]="globalFilterDate"-->
<!--                                    [globalFilterLocationId]="globalFilterLocationId"-->
<!--                                    [globalFilterClassificationId]="globalFilterClassificationId">-->
<!--                                </app-cases-hospitalized-pie-chart-dashlet>-->
<!--                            </mat-card>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </ng-template>-->
<!--            </mat-expansion-panel>-->

<!--            &lt;!&ndash; Histogram - chains of transmission &ndash;&gt;-->
<!--            <mat-expansion-panel-->
<!--                *ngIf="DashboardModel.canViewCotSizeHistogramDashlet(authUser)">-->
<!--                &lt;!&ndash; Header &ndash;&gt;-->
<!--                <mat-expansion-panel-header>-->
<!--                    <div class="other-kpi-header">-->
<!--                        {{'LNG_PAGE_DASHBOARD_HISTOGRAM_CHAINS_OF_TRANSMISSION_SIZE_TITLE' | translate}}-->
<!--                    </div>-->
<!--                </mat-expansion-panel-header>-->

<!--                &lt;!&ndash; Dashlets &ndash;&gt;-->
<!--                <ng-template matExpansionPanelContent>-->
<!--                    &lt;!&ndash; histogram - chains of transmission size &ndash;&gt;-->
<!--                    <app-histogram-transmission-chains-size-dashlet-->
<!--                        [globalFilterDate]="globalFilterDate"-->
<!--                        [globalFilterLocationId]="globalFilterLocationId"-->
<!--                        [globalFilterClassificationId]="globalFilterClassificationId">-->
<!--                    </app-histogram-transmission-chains-size-dashlet>-->
<!--                </ng-template>-->
<!--            </mat-expansion-panel>-->

<!--            &lt;!&ndash; Epidemiological Curve &ndash;&gt;-->
<!--            <mat-expansion-panel-->
<!--                *ngIf="DashboardModel.canViewEpiCurveStratifiedByClassificationDashlet(authUser) ||-->
<!--                    DashboardModel.canViewEpiCurveStratifiedByOutcomeDashlet(authUser) ||-->
<!--                    DashboardModel.canViewEpiCurveStratifiedByClassificationOverReportTimeDashlet(authUser)">-->
<!--                &lt;!&ndash; Header &ndash;&gt;-->
<!--                <mat-expansion-panel-header>-->
<!--                    <div class="other-kpi-header">-->
<!--                        {{'LNG_PAGE_DASHBOARD_EPI_CURVE_TITLE' | translate}}-->
<!--                    </div>-->
<!--                </mat-expansion-panel-header>-->

<!--                &lt;!&ndash; Dashlets &ndash;&gt;-->
<!--                <ng-template matExpansionPanelContent>-->
<!--                    &lt;!&ndash; dropdown with view types &ndash;&gt;-->
<!--                    <app-form-select-->
<!--                        name="epiCurveViewType"-->
<!--                        tooltip="LNG_PAGE_DASHBOARD_EPI_CURVE_TITLE_DESCRIPTION"-->
<!--                        [(ngModel)]="epiCurveViewType"-->
<!--                        required="true"-->
<!--                        [options]="epiCurveViewTypes$ | async"-->
<!--                        [clearable]="false">-->
<!--                    </app-form-select>-->

<!--                    &lt;!&ndash; epi curve &ndash;&gt;-->
<!--                    <app-epi-curve-dashlet-->
<!--                        *ngIf="epiCurveViewType === Constants.EPI_CURVE_TYPES.CLASSIFICATION.value && DashboardModel.canViewEpiCurveStratifiedByClassificationDashlet(authUser)"-->
<!--                        [globalFilterDate]="globalFilterDate"-->
<!--                        [globalFilterLocationId]="globalFilterLocationId"-->
<!--                        [globalFilterClassificationId]="globalFilterClassificationId">-->
<!--                    </app-epi-curve-dashlet>-->

<!--                    &lt;!&ndash; epi curve outcome &ndash;&gt;-->
<!--                    <app-epi-curve-outcome-dashlet-->
<!--                        *ngIf="epiCurveViewType === Constants.EPI_CURVE_TYPES.OUTCOME.value && DashboardModel.canViewEpiCurveStratifiedByOutcomeDashlet(authUser)"-->
<!--                        [globalFilterDate]="globalFilterDate"-->
<!--                        [globalFilterLocationId]="globalFilterLocationId"-->
<!--                        [globalFilterClassificationId]="globalFilterClassificationId">-->
<!--                    </app-epi-curve-outcome-dashlet>-->

<!--                    &lt;!&ndash; epi curve reporting &ndash;&gt;-->
<!--                    <app-epi-curve-reporting-dashlet-->
<!--                        *ngIf="epiCurveViewType === Constants.EPI_CURVE_TYPES.REPORTING.value && DashboardModel.canViewEpiCurveStratifiedByClassificationOverReportTimeDashlet(authUser)"-->
<!--                        [globalFilterDate]="globalFilterDate"-->
<!--                        [globalFilterLocationId]="globalFilterLocationId"-->
<!--                        [globalFilterClassificationId]="globalFilterClassificationId">-->
<!--                    </app-epi-curve-reporting-dashlet>-->
<!--                </ng-template>-->
<!--            </mat-expansion-panel>-->

<!--            &lt;!&ndash; Contact follow-up overview &ndash;&gt;-->
<!--            <mat-expansion-panel-->
<!--                *ngIf="DashboardModel.canViewContactFollowUpReportDashlet(authUser)">-->
<!--                &lt;!&ndash; Header &ndash;&gt;-->
<!--                <mat-expansion-panel-header>-->
<!--                    <div class="other-kpi-header">-->
<!--                        {{'LNG_PAGE_DASHBOARD_CONTACT_FOLLOW_UP_REPORT_TITLE' | translate}}-->
<!--                    </div>-->
<!--                </mat-expansion-panel-header>-->

<!--                &lt;!&ndash; Dashlets &ndash;&gt;-->
<!--                <ng-template matExpansionPanelContent>-->
<!--                    &lt;!&ndash; Contact follow-up overview c3 chart &ndash;&gt;-->
<!--                    <app-contact-follow-up-overview-dashlet-->
<!--                        [globalFilterDate]="globalFilterDate"-->
<!--                        [globalFilterLocationId]="globalFilterLocationId"-->
<!--                        [globalFilterClassificationId]="globalFilterClassificationId">-->
<!--                    </app-contact-follow-up-overview-dashlet>-->
<!--                </ng-template>-->
<!--            </mat-expansion-panel>-->

<!--            &lt;!&ndash; Cases based on contact status &ndash;&gt;-->
<!--            <mat-expansion-panel-->
<!--                *ngIf="DashboardModel.canViewContactStatusReportDashlet(authUser)">-->
<!--                &lt;!&ndash; Header &ndash;&gt;-->
<!--                <mat-expansion-panel-header>-->
<!--                    <div class="other-kpi-header">-->
<!--                        {{'LNG_PAGE_DASHBOARD_CASES_CONTACT_STATUS_REPORT_TITLE' | translate}}-->
<!--                    </div>-->
<!--                </mat-expansion-panel-header>-->

<!--                &lt;!&ndash; Dashlets &ndash;&gt;-->
<!--                <ng-template matExpansionPanelContent>-->
<!--                    &lt;!&ndash; Cases based on contact status c3 chart &ndash;&gt;-->
<!--                    <app-cases-based-on-contact-status-dashlet-->
<!--                        [globalFilterDate]="globalFilterDate"-->
<!--                        [globalFilterLocationId]="globalFilterLocationId"-->
<!--                        [globalFilterClassificationId]="globalFilterClassificationId">-->
<!--                    </app-cases-based-on-contact-status-dashlet>-->
<!--                </ng-template>-->
<!--            </mat-expansion-panel>-->

<!--            &lt;!&ndash; KPIs &ndash;&gt;-->
<!--            <div #kpiSection>-->
<!--                <ng-container-->
<!--                    *ngFor="let group of kpiGroups">-->
<!--                    <mat-expansion-panel-->
<!--                        *ngIf="group.hasAccess(authUser)"-->
<!--                        #kpiSectionGroup>-->
<!--                        &lt;!&ndash; Header &ndash;&gt;-->
<!--                        <mat-expansion-panel-header>-->
<!--                            &lt;!&ndash; KPIs section header &ndash;&gt;-->
<!--                            <div class="dashlet-kpi-header dashlet-kpi-header-100" fxLayout="row" fxLayoutAlign="space-between center">-->
<!--                                <div>-->
<!--                                    {{group.title | translate}}-->
<!--                                </div>-->

<!--                                <div>-->
<!--                                    <button-->
<!--                                        mat-icon-button-->
<!--                                        [disableRipple]="true"-->
<!--                                        (click)="$event.stopPropagation()"-->
<!--                                        [matMenuTriggerFor]="actionsMenu">-->
<!--                                        <span class="xt-icon">menu</span>-->
<!--                                    </button>-->

<!--                                    <mat-menu #actionsMenu="matMenu">-->
<!--                                        <button-->
<!--                                            type="button"-->
<!--                                            class="dashboard-kpi-menu-item"-->
<!--                                            mat-menu-item-->
<!--                                            (click)="showAllDashlets(group.id)">-->
<!--                                            {{'LNG_PAGE_DASHBOARD_KPI_SECTION_MENU_SHOW_ALL_LABEL' | translate}}-->
<!--                                        </button>-->
<!--                                    </mat-menu>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </mat-expansion-panel-header>-->
<!--                </ng-container>-->
<!--            </div>-->

<!--            <canvas id="tempCanvas"></canvas>-->

<!--        </div>-->
<!--    </ng-container>-->

<!--</div>-->
