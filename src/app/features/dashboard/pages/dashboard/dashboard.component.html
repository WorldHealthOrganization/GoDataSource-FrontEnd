<div>
    <app-topnav>
        <ng-container dynamic-section>
            <div fxLayout="row" fxFlex fxLayoutAlign="space-between center">
                <app-breadcrumbs [items]="breadcrumbs"></app-breadcrumbs>

                <div
                    *ngIf="!!selectedOutbreak?.id"
                    class="topnav-actions">

                    <button
                        *ngIf="DashboardModel.canExportCaseClassificationPerLocationReport(authUser) || DashboardModel.canExportContactFollowUpSuccessRateReport(authUser) || (
                            DashboardModel.canExportEpiCurve(authUser) && (
                                DashboardModel.canViewEpiCurveStratifiedByClassificationDashlet(authUser) ||
                                DashboardModel.canViewEpiCurveStratifiedByOutcomeDashlet(authUser) ||
                                DashboardModel.canViewEpiCurveStratifiedByClassificationOverReportTimeDashlet(authUser)
                            )
                        ) || (
                            DashboardModel.canExportKpi(authUser) &&
                            hasKpiAccess()
                        )"
                        mat-raised-button color="accent"
                        [matMenuTriggerFor]="quickActionsMenu">
                        {{'LNG_PAGE_DASHBOARD_REPORTS_BUTTON_LABEL' | translate}} <span class="xt-icon">arrowDown</span>
                    </button>

                    <mat-menu #quickActionsMenu="matMenu">
                        <app-export-button
                            *ngIf="DashboardModel.canExportCaseClassificationPerLocationReport(authUser)"
                            [menuItem]="true"
                            [fileType]="ExportDataExtension.PDF"
                            [label]="'LNG_PAGE_DASHBOARD_CASES_BY_CLASSIFICATION_LOCATION_REPORT_LABEL' | translate"
                            [message]="'LNG_PAGE_DASHBOARD_CASES_BY_CLASSIFICATION_LOCATION_REPORT_LABEL' | translate"
                            [url]="casesByClassificationAndLocationReportUrl"
                            [fileName]="'LNG_PAGE_DASHBOARD_CASES_BY_CLASSIFICATION_LOCATION_REPORT_LABEL' | translate"
                            (exportStart)="showLoadingDialog()"
                            (exportFinished)="closeLoadingDialog()"
                            [queryBuilder]="qbCaseByClassification()">
                        </app-export-button>

                        <app-export-button
                            *ngIf="DashboardModel.canExportContactFollowUpSuccessRateReport(authUser)"
                            [menuItem]="true"
                            [fileType]="ExportDataExtension.PDF"
                            [label]="'LNG_PAGE_DASHBOARD_CONTACTS_FOLLOWUP_SUCCESS_RATE_REPORT_LABEL' | translate"
                            [message]="'LNG_PAGE_DASHBOARD_CONTACTS_FOLLOWUP_SUCCESS_RATE_REPORT_LABEL' | translate"
                            [url]="contactsFollowupSuccessRateReportUrl"
                            [fileName]="'LNG_PAGE_DASHBOARD_CONTACTS_FOLLOWUP_SUCCESS_RATE_REPORT_LABEL' | translate"
                            (exportStart)="showLoadingDialog()"
                            (exportFinished)="closeLoadingDialog()"
                            [queryBuilder]="qbContactsFollowUpSuccessRate()">
                        </app-export-button>

                        <button
                            *ngIf="DashboardModel.canExportEpiCurve(authUser) && (
                                DashboardModel.canViewEpiCurveStratifiedByClassificationDashlet(authUser) ||
                                DashboardModel.canViewEpiCurveStratifiedByOutcomeDashlet(authUser) ||
                                DashboardModel.canViewEpiCurveStratifiedByClassificationOverReportTimeDashlet(authUser)
                            )"
                            mat-menu-item
                            [disabled]="x86Architecture"
                            (click)="generateEpiCurveReport()">
                            {{'LNG_PAGE_DASHBOARD_EPI_CURVE_REPORT_LABEL' | translate}}
                        </button>

                        <button
                            *ngIf="DashboardModel.canExportKpi(authUser) && hasKpiAccess()"
                            mat-menu-item
                            [disabled]="x86Architecture"
                            (click)="generateKpisReport()">
                            {{'LNG_PAGE_DASHBOARD_KPIS_REPORT_LABEL' | translate}}
                        </button>
                    </mat-menu>
                </div>
            </div>
        </ng-container>
    </app-topnav>

    <ng-container *ngIf="noOutbreaksInSystem">
        <mat-card class="page-content page-section">
            {{'LNG_PAGE_DASHBOARD_NO_OUTBREAKS_MESSAGE' | translate}}
        </mat-card>
    </ng-container>

    <ng-container *ngIf="!noOutbreaksInSystem">
        <!-- Side filters -->
        <app-side-filters
            [filterOptions]="availableSideFilters"
            (filtersCollected)="applySideFilters($event)"
            [fixedFilters]="true">
        </app-side-filters>

        <!-- Dashboard items -->
        <div
            class="page-content"
            fxLayout="column">
            <!-- Pie Charts -->
            <mat-expansion-panel
                *ngIf="DashboardModel.canViewCaseSummaryDashlet(authUser) || DashboardModel.canViewCasePerLocationLevelDashlet(authUser) || DashboardModel.canViewCaseHospitalizedPieChartDashlet(authUser)">
                <!-- Header -->
                <mat-expansion-panel-header>
                    <div class="other-kpi-header">
                        {{'LNG_PAGE_DASHBOARD_PIE_CHARTS_TITLE' | translate}}
                    </div>
                </mat-expansion-panel-header>

                <!-- Dashlets -->
                <ng-template matExpansionPanelContent>
                    <div
                        fxLayout="row"
                        fxLayoutGap="10px">
                        <!-- Summary -->
                        <div
                            *ngIf="DashboardModel.canViewCaseSummaryDashlet(authUser)"
                            fxFlex="33">
                            <mat-card
                                class="dashboard-gauge">
                                <app-case-summary-dashlet
                                    [globalFilterDate]="globalFilterDate"
                                    [globalFilterLocationId]="globalFilterLocationId"
                                    [globalFilterClassificationId]="globalFilterClassificationId">
                                </app-case-summary-dashlet>
                            </mat-card>
                        </div>

                        <!-- Location -->
                        <div
                            *ngIf="DashboardModel.canViewCasePerLocationLevelDashlet(authUser)"
                            fxFlex="33">
                            <mat-card
                                class="dashboard-gauge">
                                <app-case-by-geographic-location-dashlet
                                    [globalFilterDate]="globalFilterDate"
                                    [globalFilterLocationId]="globalFilterLocationId"
                                    [globalFilterClassificationId]="globalFilterClassificationId">
                                </app-case-by-geographic-location-dashlet>
                            </mat-card>
                        </div>

                        <!-- Hospitalized -->
                        <div
                            *ngIf="DashboardModel.canViewCaseHospitalizedPieChartDashlet(authUser)"
                            fxFlex="33">
                            <mat-card
                                class="dashboard-gauge">
                                <app-cases-hospitalized-pie-chart-dashlet
                                    [globalFilterDate]="globalFilterDate"
                                    [globalFilterLocationId]="globalFilterLocationId"
                                    [globalFilterClassificationId]="globalFilterClassificationId">
                                </app-cases-hospitalized-pie-chart-dashlet>
                            </mat-card>
                        </div>
                    </div>
                </ng-template>
            </mat-expansion-panel>

            <!-- Histogram - chains of transmission -->
            <mat-expansion-panel
                *ngIf="DashboardModel.canViewCotSizeHistogramDashlet(authUser)">
                <!-- Header -->
                <mat-expansion-panel-header>
                    <div class="other-kpi-header">
                        {{'LNG_PAGE_DASHBOARD_HISTOGRAM_CHAINS_OF_TRANSMISSION_SIZE_TITLE' | translate}}
                    </div>
                </mat-expansion-panel-header>

                <!-- Dashlets -->
                <ng-template matExpansionPanelContent>
                    <!-- histogram - chains of transmission size -->
                    <app-histogram-transmission-chains-size-dashlet
                        [globalFilterDate]="globalFilterDate"
                        [globalFilterLocationId]="globalFilterLocationId"
                        [globalFilterClassificationId]="globalFilterClassificationId">
                    </app-histogram-transmission-chains-size-dashlet>
                </ng-template>
            </mat-expansion-panel>

            <!-- Epidemiological Curve -->
            <mat-expansion-panel
                *ngIf="DashboardModel.canViewEpiCurveStratifiedByClassificationDashlet(authUser) ||
                    DashboardModel.canViewEpiCurveStratifiedByOutcomeDashlet(authUser) ||
                    DashboardModel.canViewEpiCurveStratifiedByClassificationOverReportTimeDashlet(authUser)">
                <!-- Header -->
                <mat-expansion-panel-header>
                    <div class="other-kpi-header">
                        {{'LNG_PAGE_DASHBOARD_EPI_CURVE_TITLE' | translate}}
                    </div>
                </mat-expansion-panel-header>

                <!-- Dashlets -->
                <ng-template matExpansionPanelContent>
                    <!-- dropdown with view types -->
                    <app-form-select
                        name="epiCurveViewType"
                        tooltip="LNG_PAGE_DASHBOARD_EPI_CURVE_TITLE_DESCRIPTION"
                        [(ngModel)]="epiCurveViewType"
                        required="true"
                        [options]="epiCurveViewTypes$ | async"
                        [clearable]="false">
                    </app-form-select>

                    <!-- epi curve -->
                    <app-epi-curve-dashlet
                        *ngIf="epiCurveViewType === Constants.EPI_CURVE_TYPES.CLASSIFICATION.value && DashboardModel.canViewEpiCurveStratifiedByClassificationDashlet(authUser)"
                        [globalFilterDate]="globalFilterDate"
                        [globalFilterLocationId]="globalFilterLocationId"
                        [globalFilterClassificationId]="globalFilterClassificationId">
                    </app-epi-curve-dashlet>

                    <!-- epi curve outcome -->
                    <app-epi-curve-outcome-dashlet
                        *ngIf="epiCurveViewType === Constants.EPI_CURVE_TYPES.OUTCOME.value && DashboardModel.canViewEpiCurveStratifiedByOutcomeDashlet(authUser)"
                        [globalFilterDate]="globalFilterDate"
                        [globalFilterLocationId]="globalFilterLocationId"
                        [globalFilterClassificationId]="globalFilterClassificationId">
                    </app-epi-curve-outcome-dashlet>

                    <!-- epi curve reporting -->
                    <app-epi-curve-reporting-dashlet
                        *ngIf="epiCurveViewType === Constants.EPI_CURVE_TYPES.REPORTING.value && DashboardModel.canViewEpiCurveStratifiedByClassificationOverReportTimeDashlet(authUser)"
                        [globalFilterDate]="globalFilterDate"
                        [globalFilterLocationId]="globalFilterLocationId"
                        [globalFilterClassificationId]="globalFilterClassificationId">
                    </app-epi-curve-reporting-dashlet>
                </ng-template>
            </mat-expansion-panel>

            <!-- Contact follow-up overview -->
            <mat-expansion-panel
                *ngIf="DashboardModel.canViewContactFollowUpReportDashlet(authUser)">
                <!-- Header -->
                <mat-expansion-panel-header>
                    <div class="other-kpi-header">
                        {{'LNG_PAGE_DASHBOARD_CONTACT_FOLLOW_UP_REPORT_TITLE' | translate}}
                    </div>
                </mat-expansion-panel-header>

                <!-- Dashlets -->
                <ng-template matExpansionPanelContent>
                    <!-- Contact follow-up overview c3 chart -->
                    <app-contact-follow-up-overview-dashlet
                        [globalFilterDate]="globalFilterDate"
                        [globalFilterLocationId]="globalFilterLocationId"
                        [globalFilterClassificationId]="globalFilterClassificationId">
                    </app-contact-follow-up-overview-dashlet>
                </ng-template>
            </mat-expansion-panel>

            <!-- Cases based on contact status -->
            <mat-expansion-panel
                *ngIf="DashboardModel.canViewContactStatusReportDashlet(authUser)">
                <!-- Header -->
                <mat-expansion-panel-header>
                    <div class="other-kpi-header">
                        {{'LNG_PAGE_DASHBOARD_CASES_CONTACT_STATUS_REPORT_TITLE' | translate}}
                    </div>
                </mat-expansion-panel-header>

                <!-- Dashlets -->
                <ng-template matExpansionPanelContent>
                    <!-- Cases based on contact status c3 chart -->
                    <app-cases-based-on-contact-status-dashlet
                        [globalFilterDate]="globalFilterDate"
                        [globalFilterLocationId]="globalFilterLocationId"
                        [globalFilterClassificationId]="globalFilterClassificationId">
                    </app-cases-based-on-contact-status-dashlet>
                </ng-template>
            </mat-expansion-panel>

            <!-- KPIs -->
            <div #kpiSection>
                <ng-container
                    *ngFor="let group of kpiGroups">
                    <mat-expansion-panel
                        *ngIf="group.hasAccess(authUser)"
                        #kpiSectionGroup>
                        <!-- Header -->
                        <mat-expansion-panel-header>
                            <!-- KPIs section header -->
                            <div class="dashlet-kpi-header dashlet-kpi-header-100" fxLayout="row" fxLayoutAlign="space-between center">
                                <div>
                                    {{group.title | translate}}
                                </div>

                                <div>
                                    <button
                                        mat-icon-button
                                        [disableRipple]="true"
                                        (click)="$event.stopPropagation()"
                                        [matMenuTriggerFor]="actionsMenu">
                                        <span class="xt-icon">menu</span>
                                    </button>

                                    <mat-menu #actionsMenu="matMenu">
                                        <button
                                            type="button"
                                            class="dashboard-kpi-menu-item"
                                            mat-menu-item
                                            (click)="showAllDashlets(group.id)">
                                            {{'LNG_PAGE_DASHBOARD_KPI_SECTION_MENU_SHOW_ALL_LABEL' | translate}}
                                        </button>
                                    </mat-menu>
                                </div>
                            </div>
                        </mat-expansion-panel-header>

                        <!-- Dashlets -->
                        <ng-template matExpansionPanelContent>
                            <!-- KPIs list -->
                            <div fxLayout="row wrap">
                                <ng-container *ngFor="let dashlet of group.dashlets">
                                    <ng-container *ngIf="group.permissions[dashlet] && group.permissions[dashlet].hasAccess(authUser)">
                                        <!-- Cases who have died -->
                                        <app-cases-deceased-dashlet
                                            *ngIf="dashlet === DashboardDashlet.CASES_DECEASED &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-cases-deceased-dashlet>

                                        <!-- Cases hospitalised -->
                                        <app-cases-hospitalised-dashlet
                                            *ngIf="dashlet === DashboardDashlet.CASES_HOSPITALISED &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-cases-hospitalised-dashlet>

                                        <!-- Cases with Less than x Contacts -->
                                        <app-cases-less-contacts-dashlet
                                            *ngIf="dashlet === DashboardDashlet.CASES_WITH_LESS_THAN_X_CONTACTS &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-cases-less-contacts-dashlet>

                                        <!-- New cases detected in the previous x days among contacts -->
                                        <app-new-cases-previous-days-contacts-dashlet
                                            *ngIf="dashlet === DashboardDashlet.NEW_CASES_IN_THE_PREVIOUS_X_DAYS_AMONG_KNOWN_CONTACTS &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-new-cases-previous-days-contacts-dashlet>

                                        <!-- Cases refusing to be transferred to a treatment unit -->
                                        <app-cases-refusing-treatment-dashlet
                                            *ngIf="dashlet === DashboardDashlet.SUSPECT_CASES_REFUSING_TO_BE_TRANSFERRED_TO_A_TREATMENT_UNIT &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-cases-refusing-treatment-dashlet>

                                        <!-- New cases in previous x days in known transmission chains -->
                                        <app-new-cases-previous-days-transmission-chains-dashlet
                                            *ngIf="dashlet === DashboardDashlet.NEW_CASES_IN_THE_PREVIOUS_X_DAYS_OUTSIDE_THE_TRANSMISSION_CHAINS &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-new-cases-previous-days-transmission-chains-dashlet>

                                        <!-- Suspect Cases where the lab result is pending -->
                                        <app-cases-pending-lab-results-dashlet
                                            *ngIf="dashlet === DashboardDashlet.SUSPECT_CASES_WITH_PENDING_LAB_RESULT &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-cases-pending-lab-results-dashlet>

                                        <!-- Number of cases who are not identified though known contact list -->
                                        <app-cases-not-identified-through-contacts-dashlet
                                            *ngIf="dashlet === DashboardDashlet.CASES_NOT_IDENTIFIED_THROUGH_CONTACTS &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-cases-not-identified-through-contacts-dashlet>

                                        <!-- Contacts per case mean -->
                                        <app-contacts-per-case-mean-dashlet
                                            *ngIf="dashlet === DashboardDashlet.CONTACTS_PER_CASE_MEAN &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-contacts-per-case-mean-dashlet>

                                        <!-- Contacts per case median -->
                                        <app-contacts-per-case-median-dashlet
                                            *ngIf="dashlet === DashboardDashlet.CONTACTS_PER_CASE_MEDIAN &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-contacts-per-case-median-dashlet>

                                        <!-- Contacts on the follow-up list -->
                                        <app-contacts-on-followup-list-dashlet
                                            *ngIf="dashlet === DashboardDashlet.CONTACTS_ON_THE_FOLLOW_UP_LIST &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-contacts-on-followup-list-dashlet>

                                        <!-- Contacts Lost to follow-up -->
                                        <app-contacts-lost-to-follow-up-dashlet
                                            *ngIf="dashlet === DashboardDashlet.CONTACTS_LOST_TO_FOLLOW_UP &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-contacts-lost-to-follow-up-dashlet>

                                        <!-- Contacts Not Seen -->
                                        <app-contacts-not-seen-dashlet
                                            *ngIf="dashlet === DashboardDashlet.CONTACTS_NOT_SEEN_IN_X_DAYS &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-contacts-not-seen-dashlet>

                                        <!-- Number of contacts becoming cases in period & location -->
                                        <app-contacts-become-cases-dashlet
                                            *ngIf="dashlet === DashboardDashlet.CONTACTS_BECOMING_CASES_IN_TIME_AND_SPACE &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-contacts-become-cases-dashlet>

                                        <!-- Contacts seen each day -->
                                        <app-contacts-seen-each-day-dashlet
                                            *ngIf="dashlet === DashboardDashlet.CONTACTS_SEEN_EACH_DAY &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-contacts-seen-each-day-dashlet>

                                        <!-- Contacts with successful follow-ups -->
                                        <app-contacts-with-successful-follow-ups-dashlet
                                            *ngIf="dashlet === DashboardDashlet.CONTACTS_WITH_SUCCESSFUL_FOLLOW_UP &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-contacts-with-successful-follow-ups-dashlet>

                                        <!-- number of independent chains of transmission -->
                                        <app-independent-transmission-chains-dashlet
                                            *ngIf="dashlet === DashboardDashlet.INDEPENDENT_TRANSMISSION_CHAINS &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-independent-transmission-chains-dashlet>

                                        <!-- Number of active chains of transmission -->
                                        <app-number-of-active-chains-of-transmission-dashlet
                                            *ngIf="dashlet === DashboardDashlet.ACTIVE_TRANSMISSION_CHAINS &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-number-of-active-chains-of-transmission-dashlet>

                                        <!-- Number of new chains of transmission from registered contacts who have became cases-->
                                        <app-new-chains-of-transmission-from-registered-contacts-dashlet
                                            *ngIf="dashlet === DashboardDashlet.TRANSMISSION_CHAINS_FROM_CONTACTS_WHO_BECAME_CASES &&
                                                isDashletVisible(dashlet)"
                                            (hide)="hideDashlet(dashlet)"
                                            (moveBefore)="moveDashletBefore(dashlet)"
                                            (moveAfter)="moveDashletAfter(dashlet)"
                                            [globalFilterDate]="globalFilterDate"
                                            [globalFilterLocationId]="globalFilterLocationId"
                                            [globalFilterClassificationId]="globalFilterClassificationId">
                                        </app-new-chains-of-transmission-from-registered-contacts-dashlet>
                                    </ng-container>
                                </ng-container>
                            </div>
                        </ng-template>
                    </mat-expansion-panel>
                </ng-container>
            </div>

            <canvas id="tempCanvas"></canvas>

        </div>
    </ng-container>

</div>
